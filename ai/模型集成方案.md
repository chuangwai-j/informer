# ğŸ”§ Informeræ¨¡å‹ä¸å®æ—¶ç³»ç»Ÿé›†æˆæ–¹æ¡ˆ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†å¦‚ä½•å°†ç°æœ‰çš„Informeræ¨¡å‹é›†æˆåˆ°å®æ—¶é£æœºè½¨è¿¹é¢„æµ‹ç³»ç»Ÿä¸­ï¼ŒåŒ…æ‹¬æ•°æ®æ¥å£ã€é¢„æµ‹æµç¨‹å’Œå‰åç«¯å¯¹æ¥æ–¹æ¡ˆã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®æ—¶é£æœºè½¨è¿¹é¢„æµ‹ç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å‰ç«¯å±‚ (Django Templates)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   å®æ—¶è·Ÿè¸ªé¡µé¢   â”‚  â”‚   3Då¯è§†åŒ–é¡µé¢   â”‚  â”‚   é£æœºç›‘æ§é¡µé¢   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    WebSocketé€šä¿¡å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FlightTracking â”‚  â”‚  AllFlights      â”‚  â”‚ PredictionUpdate â”‚ â”‚
â”‚  â”‚   Consumer      â”‚  â”‚   Consumer       â”‚  â”‚   Consumer       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    ä¸šåŠ¡é€»è¾‘å±‚ (Django Views)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å®æ—¶é¢„æµ‹å¼•æ“     â”‚  â”‚   æ•°æ®æ¥æ”¶å™¨     â”‚  â”‚   å¯è§†åŒ–ç»„ä»¶     â”‚  â”‚
â”‚  â”‚ (PredictionEngine)â”‚ â”‚ (DataReceiver)   â”‚  â”‚(RealtimeVisualizer)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ¨¡å‹å±‚ (Informer)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Informeræ¨¡å‹ (å·²è®­ç»ƒ)                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚   ç¼–ç å™¨     â”‚  â”‚   è§£ç å™¨     â”‚  â”‚   ProbAttention     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ (Encoder)   â”‚  â”‚ (Decoder)   â”‚  â”‚  (æ³¨æ„åŠ›æœºåˆ¶)        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ•°æ®å±‚ (Django Models)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Aircraft      â”‚  â”‚   FlightData    â”‚  â”‚  PredictionResult â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”Œ æ¨¡å‹é›†æˆæ¥å£

### 1. æ•°æ®è¾“å…¥æ ¼å¼

#### å®æ—¶æ•°æ®è¾“å…¥æ ¼å¼
```python
# é£æœºæ•°æ®ç‚¹æ ¼å¼
flight_data_point = {
    'flight_id': str,           # èˆªç­å· (å¦‚: "CA1234")
    'callsign': str,            # å‘¼å· (å¦‚: "CCA1234")
    'timestamp': datetime,      # æ—¶é—´æˆ³
    'latitude': float,          # çº¬åº¦ (åº¦)
    'longitude': float,         # ç»åº¦ (åº¦)
    'geo_altitude': float,      # å‡ ä½•é«˜åº¦ (ç±³)
    'baro_altitude': float,     # æ°”å‹é«˜åº¦ (ç±³)
    'speed': float,             # é€Ÿåº¦ (m/s)
    'heading': float,           # èˆªå‘ (åº¦)
    'vertical_rate': float,     # å‚ç›´é€Ÿåº¦ (m/s)
    'status': str,              # é£è¡ŒçŠ¶æ€
    'data_quality': int         # æ•°æ®è´¨é‡ (0-100)
}

# è½¨è¿¹ç¼“å†²åŒºæ ¼å¼
trajectory_buffer = {
    'flight_id': str,
    'points': [flight_data_point],  # æ—¶é—´åºåˆ—æ•°æ®ç‚¹
    'last_update': datetime,
    'buffer_size': int             # ç¼“å†²åŒºå¤§å° (é»˜è®¤100)
}
```

#### æ¨¡å‹è¾“å…¥æ ¼å¼
```python
# Informeræ¨¡å‹è¾“å…¥å¼ é‡
model_input = {
    'seq_x': torch.Tensor,      # [batch_size, seq_len, 4] è¾“å…¥åºåˆ—
    'seq_y': torch.Tensor,      # [batch_size, label_len+pred_len, 4] ç›®æ ‡åºåˆ—
    'seq_x_mark': torch.Tensor, # [batch_size, seq_len, 4] è¾“å…¥æ—¶é—´ç‰¹å¾
    'seq_y_mark': torch.Tensor  # [batch_size, label_len+pred_len, 4] ç›®æ ‡æ—¶é—´ç‰¹å¾
}

# ç‰¹å¾ç»´åº¦å¯¹åº”
feature_mapping = {
    0: 'latitude',      # çº¬åº¦
    1: 'longitude',     # ç»åº¦
    2: 'geo_altitude',  # å‡ ä½•é«˜åº¦
    3: 'baro_altitude'  # æ°”å‹é«˜åº¦
}
```

### 2. é¢„æµ‹è¾“å‡ºæ ¼å¼

#### åŸå§‹æ¨¡å‹è¾“å‡º
```python
# Informeræ¨¡å‹è¾“å‡º
model_output = {
    'prediction': torch.Tensor,  # [batch_size, pred_len, 4] é¢„æµ‹åºåˆ—
    'confidence': float,         # é¢„æµ‹ç½®ä¿¡åº¦
    'processing_time': float     # å¤„ç†æ—¶é—´(æ¯«ç§’)
}

# é¢„æµ‹è½¨è¿¹ç‚¹æ ¼å¼
predicted_point = {
    'latitude': float,           # é¢„æµ‹çº¬åº¦
    'longitude': float,          # é¢„æµ‹ç»åº¦
    'geo_altitude': float,       # é¢„æµ‹å‡ ä½•é«˜åº¦
    'baro_altitude': float,      # é¢„æµ‹æ°”å‹é«˜åº¦
    'confidence': float,         # è¯¥ç‚¹ç½®ä¿¡åº¦
    'timestamp': datetime        # é¢„æµ‹æ—¶é—´æˆ³
}
```

#### ç³»ç»Ÿè¾“å‡ºæ ¼å¼
```python
# ç³»ç»Ÿç»Ÿä¸€è¾“å‡ºæ ¼å¼
system_output = {
    'flight_id': str,
    'prediction_time': datetime,
    'base_time': datetime,           # åŸºå‡†æ—¶é—´(é¢„æµ‹èµ·å§‹ç‚¹)
    'predicted_trajectory': List[predicted_point],
    'confidence_scores': {
        'overall': float,             # æ•´ä½“ç½®ä¿¡åº¦
        'by_feature': [float]*4,     # å„ç‰¹å¾ç½®ä¿¡åº¦
        'by_timestep': [float]*pred_len  # å„æ—¶é—´æ­¥ç½®ä¿¡åº¦
    },
    'model_metrics': {
        'mae': float,                # å¹³å‡ç»å¯¹è¯¯å·®
        'mse': float,                # å‡æ–¹è¯¯å·®
        'rmse': float,               # å‡æ–¹æ ¹è¯¯å·®
        'processing_time_ms': int    # å¤„ç†æ—¶é—´
    },
    'metadata': {
        'input_sequence_length': int,
        'prediction_horizon': int,
        'model_version': str,
        'is_valid': bool
    }
}
```

## ğŸ”„ å®æ—¶é¢„æµ‹æµç¨‹

### 1. æ•°æ®æ¥æ”¶å’Œé¢„å¤„ç†
```python
# prediction_engine.py æ ¸å¿ƒæµç¨‹
async def process_flight_data(self, flight_data: Dict):
    """
    å¤„ç†æ–°çš„é£è¡Œæ•°æ®ç‚¹

    Args:
        flight_data: é£æœºæ•°æ®ç‚¹

    æµç¨‹:
    1. æ›´æ–°è½¨è¿¹ç¼“å†²åŒº
    2. æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
    3. æ•°æ®æ ‡å‡†åŒ–
    4. è§¦å‘é¢„æµ‹æ¡ä»¶æ£€æŸ¥
    5. è°ƒç”¨æ¨¡å‹é¢„æµ‹
    """

    # æ­¥éª¤1: æ›´æ–°ç¼“å†²åŒº
    self.trajectory_buffers[flight_id].append(flight_data)

    # æ­¥éª¤2: æ£€æŸ¥æ•°æ®é‡
    if len(buffer) < self.args.seq_len:
        return  # æ•°æ®ä¸è¶³

    # æ­¥éª¤3: æ•°æ®æ ‡å‡†åŒ–
    normalized_input = self._prepare_input_data(buffer)

    # æ­¥éª¤4: æ‰§è¡Œé¢„æµ‹
    prediction = await self._predict_trajectory(normalized_input)

    # æ­¥éª¤5: åå¤„ç†å’Œå¹¿æ’­
    confidence = await self._calculate_confidence(flight_id, prediction)
    await self._broadcast_prediction_update(flight_id, prediction, confidence)
```

### 2. æ¨¡å‹é¢„æµ‹è°ƒç”¨
```python
async def _predict_trajectory(self, input_data: np.ndarray) -> np.ndarray:
    """
    æ‰§è¡ŒInformeræ¨¡å‹é¢„æµ‹

    Args:
        input_data: [seq_len, 4] æ ‡å‡†åŒ–è¾“å…¥æ•°æ®

    Returns:
        prediction: [pred_len, 4] é¢„æµ‹ç»“æœ
    """

    # è½¬æ¢ä¸ºæ¨¡å‹è¾“å…¥æ ¼å¼
    input_tensor = torch.FloatTensor(input_data).unsqueeze(0).to(self.device)

    # å‡†å¤‡è§£ç å™¨è¾“å…¥
    batch_size, seq_len, feature_dim = input_tensor.shape
    dec_input = torch.zeros(batch_size, self.args.label_len + self.args.pred_len, feature_dim).to(self.device)
    dec_input[:, :self.args.label_len, :] = input_tensor[:, -self.args.label_len:, :]

    # æ—¶é—´ç‰¹å¾ (ç®€åŒ–ç‰ˆæœ¬)
    time_features = torch.zeros(batch_size, self.args.label_len + self.args.pred_len, 4).to(self.device)

    # æ‰§è¡Œé¢„æµ‹
    with torch.no_grad():
        outputs = self.model(input_tensor, time_features, dec_input, time_features)
        prediction = outputs[:, -self.args.pred_len:, :].cpu().numpy()

    return prediction[0]
```

### 3. æ•°æ®æ ‡å‡†åŒ–å¤„ç†
```python
def _prepare_input_data(self, buffer: deque) -> Optional[np.ndarray]:
    """
    å‡†å¤‡æ¨¡å‹è¾“å…¥æ•°æ®

    å…³é”®ç‚¹:
    1. ä½¿ç”¨ä¸è®­ç»ƒæ—¶ç›¸åŒçš„æ ‡å‡†åŒ–å‚æ•°
    2. æ—¶é—´åºåˆ—å¯¹é½
    3. å¼‚å¸¸å€¼å¤„ç†
    """

    # æå–æœ€è¿‘çš„seq_lenä¸ªæ•°æ®ç‚¹
    recent_data = list(buffer)[-self.args.seq_len:]

    # è½¬æ¢ä¸ºnumpyæ•°ç»„ [seq_len, 4]
    features = []
    for point in recent_data:
        features.append([
            point['latitude'],
            point['longitude'],
            point['geo_altitude'],
            point['baro_altitude']
        ])

    input_array = np.array(features, dtype=np.float32)

    # âš ï¸ é‡è¦: ä½¿ç”¨è®­ç»ƒæ—¶çš„æ ‡å‡†åŒ–å‚æ•°
    # è¿™é‡Œéœ€è¦ä»è®­ç»ƒæ•°æ®é›†ä¸­è·å–meanå’Œstd
    mean = np.array([LATITUDE_MEAN, LONGITUDE_MEAN, ALTITUDE_MEAN, BARO_ALTITUDE_MEAN])
    std = np.array([LATITUDE_STD, LONGITUDE_STD, ALTITUDE_STD, BARO_ALTITUDE_STD])

    # æ ‡å‡†åŒ–
    normalized_input = (input_array - mean) / std

    return normalized_input
```

## ğŸŒ å‰åç«¯å¯¹æ¥æ–¹æ¡ˆ

### 1. WebSocketé€šä¿¡åè®®

#### å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨æ¶ˆæ¯æ ¼å¼
```javascript
// è¿æ¥é£æœºè·Ÿè¸ª
{
    "type": "subscribe_flight",
    "flight_id": "CA1234"
}

// è¯·æ±‚å½“å‰ä½ç½®
{
    "type": "get_current_position"
}

// å¼€å§‹è·Ÿè¸ª
{
    "type": "start_tracking",
    "config": {
        "update_interval": 30,
        "prediction_horizon": 24
    }
}
```

#### æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯æ ¼å¼
```javascript
// ä½ç½®æ›´æ–°
{
    "type": "position_update",
    "flight_id": "CA1234",
    "timestamp": "2024-01-01T12:00:00Z",
    "position": {
        "latitude": 39.9042,
        "longitude": 116.4074,
        "altitude": 10000,
        "speed": 250,
        "heading": 45
    }
}

// é¢„æµ‹æ›´æ–°
{
    "type": "prediction_update",
    "flight_id": "CA1234",
    "timestamp": "2024-01-01T12:00:00Z",
    "prediction": [
        [lat1, lon1, alt1, baro1],
        [lat2, lon2, alt2, baro2],
        // ... pred_lenä¸ªç‚¹
    ],
    "confidence": 0.85
}
```

### 2. REST APIæ¥å£

#### å®æ—¶æ§åˆ¶æ¥å£
```python
# å¯åŠ¨å®æ—¶è·Ÿè¸ª
POST /api/start_tracking/
Response: {
    "status": "success",
    "message": "å®æ—¶è·Ÿè¸ªå·²å¯åŠ¨",
    "timestamp": "2024-01-01T12:00:00Z"
}

# åœæ­¢å®æ—¶è·Ÿè¸ª
POST /api/stop_tracking/
Response: {
    "status": "success",
    "message": "å®æ—¶è·Ÿè¸ªå·²åœæ­¢"
}

# è·å–å¯è§†åŒ–æ•°æ®
GET /api/get_visualization/?view=3d&flight_id=CA1234
Response: {
    "status": "success",
    "plot_data": {
        "data": [...],  # Plotlyå›¾è¡¨æ•°æ®
        "layout": {...}
    }
}
```

#### çŠ¶æ€æŸ¥è¯¢æ¥å£
```python
# è·å–é£æœºçŠ¶æ€
GET /api/flight_status/
Response: {
    "status": "success",
    "flights": [
        {
            "flight_id": "CA1234",
            "callsign": "CCA1234",
            "current_status": "cruising",
            "current_latitude": 39.9042,
            "current_longitude": 116.4074,
            "current_altitude": 10000,
            "current_speed": 250,
            "current_heading": 45,
            "last_update": "2024-01-01T12:00:00Z"
        }
    ]
}
```

### 3. å‰ç«¯JavaScripté›†æˆ

#### WebSocketå®¢æˆ·ç«¯
```javascript
class FlightTrackingClient {
    constructor(flightId) {
        this.flightId = flightId;
        this.ws = null;
        this.callbacks = {};
    }

    connect() {
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        const wsUrl = `${protocol}//${window.location.host}/ws/flight/tracking/${this.flightId}/`;

        this.ws = new WebSocket(wsUrl);

        this.ws.onopen = () => {
            console.log(`Connected to flight ${this.flightId}`);
            this.sendRequest('get_current_position');
        };

        this.ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            this.handleMessage(data);
        };
    }

    sendRequest(type, data = {}) {
        if (this.ws && this.ws.readyState === WebSocket.OPEN) {
            this.ws.send(JSON.stringify({ type, ...data, flight_id: this.flightId }));
        }
    }

    handleMessage(data) {
        switch(data.type) {
            case 'position_update':
                this.onPositionUpdate(data);
                break;
            case 'prediction_update':
                this.onPredictionUpdate(data);
                break;
            case 'error':
                this.onError(data);
                break;
        }
    }

    onPositionUpdate(data) {
        // æ›´æ–°3Dè½¨è¿¹
        if (this.callbacks.positionUpdate) {
            this.callbacks.positionUpdate(data);
        }
    }

    onPredictionUpdate(data) {
        // æ›´æ–°é¢„æµ‹è½¨è¿¹
        if (this.callbacks.predictionUpdate) {
            this.callbacks.predictionUpdate(data);
        }
    }
}
```

## ğŸ“Š æ•°æ®æµå’Œæ—¶åº

### 1. å®æ—¶æ•°æ®æµæ—¶åºå›¾
```
æ—¶é—´è½´: -----> (æ¯2ç§’)
[æ•°æ®æ¥æ”¶] -> [ç¼“å†²åŒºæ›´æ–°] -> [æ¨¡å‹é¢„æµ‹] -> [WebSocketå¹¿æ’­] -> [å‰ç«¯æ›´æ–°]
    |            |              |             |             |
    v            v              v             v             v
ADS-Bæ•°æ® -> è½¨è¿¹ç¼“å†²åŒº -> Informeræ¨¡å‹ -> å®æ—¶æ¨é€ -> 3Då¯è§†åŒ–
```

### 2. é¢„æµ‹è§¦å‘æœºåˆ¶
```python
# é¢„æµ‹è§¦å‘æ¡ä»¶
PREDICTION_TRIGGERS = {
    'data_threshold': 96,      # æœ€å°‘æ•°æ®ç‚¹æ•°
    'time_interval': 30,       # æ—¶é—´é—´éš”(ç§’)
    'position_change': 0.001,  # ä½ç½®å˜åŒ–é˜ˆå€¼(åº¦)
    'altitude_change': 100,    # é«˜åº¦å˜åŒ–é˜ˆå€¼(ç±³)
}

# è§¦å‘æ£€æŸ¥é€»è¾‘
async def _check_and_predict(self, flight_id: str):
    buffer = self.trajectory_buffers[flight_id]

    # æ¡ä»¶1: æ•°æ®é‡æ£€æŸ¥
    if len(buffer) < self.args.seq_len:
        return

    # æ¡ä»¶2: æ—¶é—´é—´éš”æ£€æŸ¥
    if flight_id in self.prediction_cache:
        last_time = self.prediction_cache[flight_id]['timestamp']
        if (datetime.now() - last_time).seconds < self.update_interval:
            return

    # æ¡ä»¶3: æ˜¾è‘—å˜åŒ–æ£€æŸ¥
    if self._has_significant_change(buffer):
        await self._generate_prediction(flight_id)
```

## ğŸ”§ é…ç½®å’Œéƒ¨ç½²

### 1. æ¨¡å‹é…ç½®æ–‡ä»¶
```yaml
# config/realtime_config.yaml
realtime:
  # æ•°æ®é…ç½®
  update_interval: 30          # é¢„æµ‹æ›´æ–°é—´éš”(ç§’)
  buffer_size: 100             # è½¨è¿¹ç¼“å†²åŒºå¤§å°
  max_flights: 50              # æœ€å¤§è·Ÿè¸ªé£æœºæ•°

  # æ¨¡å‹é…ç½®
  model_path: "../checkpoints/checkpoint.pth"
  seq_len: 96
  pred_len: 24
  confidence_threshold: 0.8

  # æ•°æ®æ ‡å‡†åŒ–å‚æ•° (ä»è®­ç»ƒæ•°æ®è·å–)
  normalization:
    latitude:
      mean: 47.916
      std: 3.127
    longitude:
      mean: 8.103
      std: 5.279
    geo_altitude:
      mean: 10205
      std: 2281
    baro_altitude:
      mean: 10065
      std: 2264
```

### 2. ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env
# Djangoé…ç½®
DJANGO_SETTINGS_MODULE=django_informer.settings
DEBUG=True
ALLOWED_HOSTS=127.0.0.1,localhost

# Redisé…ç½® (ç”¨äºç”Ÿäº§ç¯å¢ƒ)
REDIS_URL=redis://localhost:6379/0

# æ¨¡å‹é…ç½®
MODEL_PATH=/path/to/checkpoints/checkpoint.pth
CONFIG_PATH=/path/to/config/aircraft.yaml

# å®æ—¶ç³»ç»Ÿé…ç½®
MAX_CONCURRENT_TRACKING=50
WEBSOCKET_HEARTBEAT_INTERVAL=30
```

## ğŸš€ éƒ¨ç½²å’Œè¿è¡Œ

### 1. å¼€å‘ç¯å¢ƒè¿è¡Œ
```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. æ•°æ®åº“è¿ç§»
python manage.py makemigrations
python manage.py migrate

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨ (æ”¯æŒWebSocket)
python manage.py runserver

# 4. è®¿é—®å®æ—¶è·Ÿè¸ªé¡µé¢
# http://127.0.0.1:8000/realtime/
```

### 2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# 1. ä½¿ç”¨ASGIæœåŠ¡å™¨ (å¦‚ Daphne)
pip install daphne
daphne django_informer.asgi:application -b 0.0.0.0 -p 8000

# 2. é…ç½®åå‘ä»£ç† (Nginx)
# WebSocketé…ç½®éœ€è¦ç‰¹æ®Šå¤„ç†

# 3. å¯åŠ¨Redis (å¦‚æœä½¿ç”¨Redisä½œä¸ºchannel layer)
redis-server

# 4. é…ç½®ç¯å¢ƒå˜é‡
export DJANGO_SETTINGS_MODULE=django_informer.settings.production
```

## ğŸ” æ•…éšœæ’é™¤

### 1. å¸¸è§é—®é¢˜

#### æ¨¡å‹åŠ è½½å¤±è´¥
```
é”™è¯¯: FileNotFoundError: ../checkpoints/checkpoint.pth
è§£å†³: ç¡®ä¿æ¨¡å‹æ£€æŸ¥ç‚¹æ–‡ä»¶å­˜åœ¨ä¸”è·¯å¾„æ­£ç¡®
```

#### WebSocketè¿æ¥å¤±è´¥
```
é”™è¯¯: WebSocket connection failed
è§£å†³: æ£€æŸ¥ASGIé…ç½®å’Œç«¯å£è®¾ç½®
```

#### æ•°æ®æ ‡å‡†åŒ–é”™è¯¯
```
é”™è¯¯: é¢„æµ‹ç»“æœå¼‚å¸¸
è§£å†³: ç¡®ä¿ä½¿ç”¨ä¸è®­ç»ƒæ—¶ç›¸åŒçš„æ ‡å‡†åŒ–å‚æ•°
```

### 2. è°ƒè¯•å·¥å…·

#### æ—¥å¿—é…ç½®
```python
# settings.py
LOGGING = {
    'version': 1,
    'loggers': {
        'model_evaluator': {
            'handlers': ['file', 'console'],
            'level': 'INFO',
        },
        'prediction_engine': {
            'handlers': ['file', 'console'],
            'level': 'DEBUG',
        }
    }
}
```

#### æ€§èƒ½ç›‘æ§
```python
# æ·»åŠ æ€§èƒ½ç›‘æ§è£…é¥°å™¨
def performance_monitor(func):
    def wrapper(*args, **kwargs):
        start_time = time.time()
        result = func(*args, **kwargs)
        processing_time = (time.time() - start_time) * 1000
        logger.info(f"{func.__name__} æ‰§è¡Œæ—¶é—´: {processing_time:.2f}ms")
        return result
    return wrapper
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ¨¡å‹ä¼˜åŒ–
- ä½¿ç”¨TensorRTæˆ–ONNXä¼˜åŒ–æ¨ç†é€Ÿåº¦
- æ‰¹é‡å¤„ç†å¤šä¸ªé£æœºçš„é¢„æµ‹
- æ¨¡å‹é‡åŒ–å‡å°‘å†…å­˜å ç”¨

### 2. ç³»ç»Ÿä¼˜åŒ–
- ä½¿ç”¨Redisä½œä¸ºchannel layeræé«˜å¹¶å‘æ€§èƒ½
- å®ç°è¿æ¥æ± ç®¡ç†WebSocketè¿æ¥
- æ·»åŠ ç¼“å­˜æœºåˆ¶å‡å°‘é‡å¤è®¡ç®—

### 3. æ•°æ®åº“ä¼˜åŒ–
- ä¸ºæ—¶é—´æˆ³å­—æ®µæ·»åŠ ç´¢å¼•
- å®šæœŸæ¸…ç†å†å²æ•°æ®
- ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± 

## ğŸ¯ æ€»ç»“

æœ¬é›†æˆæ–¹æ¡ˆå°†Informeræ¨¡å‹æ— ç¼é›†æˆåˆ°å®æ—¶é¢„æµ‹ç³»ç»Ÿä¸­ï¼Œé€šè¿‡æ ‡å‡†åŒ–çš„æ•°æ®æ¥å£ã€é«˜æ•ˆçš„é€šä¿¡æœºåˆ¶å’Œå®Œå–„çš„é”™è¯¯å¤„ç†ï¼Œå®ç°äº†ä»æ¨¡å‹åˆ°å®æ—¶åº”ç”¨çš„å®Œæ•´æ•°æ®æµã€‚ç³»ç»Ÿæ”¯æŒå¤šé£æœºå¹¶å‘è·Ÿè¸ªã€å®æ—¶3Då¯è§†åŒ–å’Œæ€§èƒ½ç›‘æ§ï¼Œä¸ºé£æœºè½¨è¿¹é¢„æµ‹æä¾›äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚